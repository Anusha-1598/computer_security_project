{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import DOMPurify from\"dompurify\";import{setFormData,resetForm}from\"../redux/registerSlice\";import FormInput from\"./FormInput\";import{useNavigate}from\"react-router-dom\";import Button from\"./Button\";import\"./Register.css\";import{setLoginUser}from\"../redux/loginSlice\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Register=()=>{const dispatch=useDispatch();const formData=useSelector(state=>state.register);const navigate=useNavigate();const[errors,setErrors]=useState({});const[message,setMessage]=useState(\"\");const[passwordVisible,setPasswordVisible]=useState(false);const[confirmPasswordVisible,setConfirmPasswordVisible]=useState(false);useEffect(()=>{fetch(\"http://127.0.0.1:5000/verifyCookie\",{method:\"POST\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\",'Access-Control-Allow-Origin':\"http://127.0.0.1:3000\"}}).then(res=>{if(res.status===200){res.json().then(res=>{dispatch(setLoginUser(res.userId));let goToDashBoard=()=>navigate(\"/dashboard\");goToDashBoard();});}}).catch(err=>{// alert(err.message);\n});},[]);const handleChange=e=>{const sanitizedValue=DOMPurify.sanitize(e.target.value);dispatch(setFormData({name:e.target.name,value:sanitizedValue}));};const validate=()=>{const errors={};if(!formData.username.trim()){errors.username=\"Username is required\";}if(!formData.password){errors.password=\"Password is required\";}else if(formData.password.length<6){errors.password=\"Password must be at least 6 characters\";}if(formData.password!==formData.confirmPassword){errors.confirmPassword=\"Passwords do not match\";}return errors;};const handleSubmit=async e=>{e.preventDefault();const validationErrors=validate();if(Object.keys(validationErrors).length>0){setErrors(validationErrors);return;}try{const response=await fetch(\"http://127.0.0.1:5000/register\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({username:formData.username,password:formData.password,confirmPassword:formData.confirmPassword})});const data=await response.json();if(response.ok){setMessage(\"Registration successful!\");dispatch(resetForm());}else{setMessage(\"Registration failed: \".concat(data.message));}}catch(error){setMessage(\"Registration failed: \".concat(error.message));}};return/*#__PURE__*/_jsxs(\"div\",{className:\"register\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Register\"}),message&&/*#__PURE__*/_jsx(\"p\",{children:message}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(FormInput,{type:\"text\",name:\"username\",label:\"Username\",value:formData.username,onChange:handleChange,error:errors.username}),/*#__PURE__*/_jsx(FormInput,{type:passwordVisible?\"text\":\"password\",name:\"password\",label:\"Password\",value:formData.password,onChange:handleChange,error:errors.password,toggleVisibility:()=>setPasswordVisible(!passwordVisible),isPassword:true}),/*#__PURE__*/_jsx(FormInput,{type:confirmPasswordVisible?\"text\":\"password\",name:\"confirmPassword\",label:\"Confirm Password\",value:formData.confirmPassword,onChange:handleChange,error:errors.confirmPassword,toggleVisibility:()=>setConfirmPasswordVisible(!confirmPasswordVisible),isPassword:true}),/*#__PURE__*/_jsx(Button,{type:\"submit\",label:\"Register\"})]})]});};export default Register;","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","DOMPurify","setFormData","resetForm","FormInput","useNavigate","Button","setLoginUser","jsx","_jsx","jsxs","_jsxs","Register","dispatch","formData","state","register","navigate","errors","setErrors","message","setMessage","passwordVisible","setPasswordVisible","confirmPasswordVisible","setConfirmPasswordVisible","fetch","method","credentials","headers","then","res","status","json","userId","goToDashBoard","catch","err","handleChange","e","sanitizedValue","sanitize","target","value","name","validate","username","trim","password","length","confirmPassword","handleSubmit","preventDefault","validationErrors","Object","keys","response","body","JSON","stringify","data","ok","concat","error","className","children","onSubmit","type","label","onChange","toggleVisibility","isPassword"],"sources":["/workspaces/computer_security_project/frontend/src/components/Register.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport DOMPurify from \"dompurify\";\nimport { setFormData, resetForm } from \"../redux/registerSlice\";\nimport FormInput from \"./FormInput\";\nimport { useNavigate } from \"react-router-dom\";\nimport Button from \"./Button\";\nimport \"./Register.css\";\nimport { setLoginUser } from \"../redux/loginSlice\";\n\nconst Register = () => {\n  const dispatch = useDispatch();\n  const formData = useSelector((state) => state.register);\n  const navigate = useNavigate();\n  const [errors, setErrors] = useState({});\n  const [message, setMessage] = useState(\"\");\n  const [passwordVisible, setPasswordVisible] = useState(false);\n  const [confirmPasswordVisible, setConfirmPasswordVisible] = useState(false);\n\n  useEffect(() => {\n    fetch(\"http://127.0.0.1:5000/verifyCookie\", {\n      method: \"POST\",\n      credentials: \"include\",headers: {\n        \"Content-Type\": \"application/json\",\n        'Access-Control-Allow-Origin': \"http://127.0.0.1:3000\"\n      }\n    })\n      .then((res) => {\n        if (res.status === 200) {\n          res.json().then((res) => {\n            dispatch(setLoginUser(res.userId));\n            let goToDashBoard = () => navigate(\"/dashboard\");\n            goToDashBoard();\n          });\n        }\n      })\n      .catch((err) => {\n        // alert(err.message);\n      });\n  }, []);\n\n  const handleChange = (e) => {\n    const sanitizedValue = DOMPurify.sanitize(e.target.value);\n    dispatch(setFormData({ name: e.target.name, value: sanitizedValue }));\n  };\n\n  const validate = () => {\n    const errors = {};\n    if (!formData.username.trim()) {\n      errors.username = \"Username is required\";\n    }\n    if (!formData.password) {\n      errors.password = \"Password is required\";\n    } else if (formData.password.length < 6) {\n      errors.password = \"Password must be at least 6 characters\";\n    }\n    if (formData.password !== formData.confirmPassword) {\n      errors.confirmPassword = \"Passwords do not match\";\n    }\n    return errors;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    const validationErrors = validate();\n    if (Object.keys(validationErrors).length > 0) {\n      setErrors(validationErrors);\n      return;\n    }\n    try {\n      const response = await fetch(\"http://127.0.0.1:5000/register\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          username: formData.username,\n          password: formData.password,\n          confirmPassword: formData.confirmPassword,\n        }),\n      });\n      const data = await response.json();\n      if (response.ok) {\n        setMessage(\"Registration successful!\");\n        dispatch(resetForm());\n      } else {\n        setMessage(`Registration failed: ${data.message}`);\n      }\n    } catch (error) {\n      setMessage(`Registration failed: ${error.message}`);\n    }\n  };\n\n  return (\n    <div className=\"register\">\n      <h2>Register</h2>\n      {message && <p>{message}</p>}\n      <form onSubmit={handleSubmit}>\n        <FormInput\n          type=\"text\"\n          name=\"username\"\n          label=\"Username\"\n          value={formData.username}\n          onChange={handleChange}\n          error={errors.username}\n        />\n        <FormInput\n          type={passwordVisible ? \"text\" : \"password\"}\n          name=\"password\"\n          label=\"Password\"\n          value={formData.password}\n          onChange={handleChange}\n          error={errors.password}\n          toggleVisibility={() => setPasswordVisible(!passwordVisible)}\n          isPassword\n        />\n        <FormInput\n          type={confirmPasswordVisible ? \"text\" : \"password\"}\n          name=\"confirmPassword\"\n          label=\"Confirm Password\"\n          value={formData.confirmPassword}\n          onChange={handleChange}\n          error={errors.confirmPassword}\n          toggleVisibility={() =>\n            setConfirmPasswordVisible(!confirmPasswordVisible)\n          }\n          isPassword\n        />\n        <Button type=\"submit\" label=\"Register\" />\n      </form>\n    </div>\n  );\n};\n\nexport default Register;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}