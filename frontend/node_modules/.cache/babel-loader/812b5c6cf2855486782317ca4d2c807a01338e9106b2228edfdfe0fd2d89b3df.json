{"ast":null,"code":"import React,{useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{updateSharedUsers}from\"../redux/documentsSlice\";import\"./Popup.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SharePopup=_ref=>{let{fileId,sharedUsers=[],onClose}=_ref;const[users,setUsers]=useState(sharedUsers);const[newUserId,setNewUserId]=useState(\"\");const[permissions,setPermissions]=useState({view:false,edit:false});const[error,setError]=useState(\"\");const dispatch=useDispatch();const currentUser=useSelector(state=>state.login.loginUser);const handleAddUser=()=>{const userPermissions=Object.keys(permissions).filter(permission=>permissions[permission]);if(newUserId&&userPermissions.length>0&&!users.some(user=>user.userId===newUserId)){setUsers([...users,{userId:newUserId,permissions:userPermissions}]);setNewUserId(\"\");setPermissions({view:false,edit:false});setError(\"\");}else{setError(\"Please enter a valid user ID and select at least one permission.\");}};const handleRemoveUser=userId=>{setUsers(users.filter(user=>user.userId!==userId));};const handlePermissionChange=e=>{const{name,checked}=e.target;setPermissions({...permissions,[name]:checked});};const handleSave=()=>{let su=[];for(var i=0;i<sharedUsers.length;i++){su.push({userId:sharedUsers[i].userId,permission:sharedUsers[i].permissions.join(\",\")});}console.log(su);fetch(\"http://127.0.0.1:5000/updateFilePermissions\",{method:\"POST\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userId:currentUser,fileId:fileId,sharedUsers:su})}).then(res=>{if(res.status===200){res.json().then(res=>{dispatch(updateSharedUsers({fileId,sharedUsers:users}));});}else{res.json().then(res=>{alert(res.message);});}}).catch(err=>{alert(\"Failed to fetch documents due to : \\n\"+err.message);});onClose();};return/*#__PURE__*/_jsx(\"div\",{className:\"popup\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"popup-inner\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Share Document\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter user ID\",value:newUserId,onChange:e=>setNewUserId(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"view\",checked:permissions.view,onChange:handlePermissionChange}),\"View\"]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"edit\",checked:permissions.edit,onChange:handlePermissionChange}),\"Edit\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAddUser,children:\"Add User\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error})]}),/*#__PURE__*/_jsx(\"ul\",{children:users.map(user=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[user.userId,\" - \",user.permissions.join(\", \")]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRemoveUser(user.userId),children:\"Remove\"})]},user.userId))}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,children:\"Cancel\"})]})});};export default SharePopup;","map":{"version":3,"names":["React","useState","useDispatch","useSelector","updateSharedUsers","jsx","_jsx","jsxs","_jsxs","SharePopup","_ref","fileId","sharedUsers","onClose","users","setUsers","newUserId","setNewUserId","permissions","setPermissions","view","edit","error","setError","dispatch","currentUser","state","login","loginUser","handleAddUser","userPermissions","Object","keys","filter","permission","length","some","user","userId","handleRemoveUser","handlePermissionChange","e","name","checked","target","handleSave","su","i","push","join","console","log","fetch","method","credentials","headers","body","JSON","stringify","then","res","status","json","alert","message","catch","err","className","children","type","placeholder","value","onChange","onClick","map"],"sources":["/workspaces/computer_security_project/frontend/src/components/SharePopup.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { updateSharedUsers } from \"../redux/documentsSlice\";\nimport \"./Popup.css\";\n\nconst SharePopup = ({ fileId, sharedUsers = [], onClose }) => {\n  const [users, setUsers] = useState(sharedUsers);\n  const [newUserId, setNewUserId] = useState(\"\");\n  const [permissions, setPermissions] = useState({ view: false, edit: false });\n  const [error, setError] = useState(\"\");\n  const dispatch = useDispatch();\n  const currentUser = useSelector((state) => state.login.loginUser);\n\n  const handleAddUser = () => {\n    const userPermissions = Object.keys(permissions).filter(\n      (permission) => permissions[permission]\n    );\n    if (\n      newUserId &&\n      userPermissions.length > 0 &&\n      !users.some((user) => user.userId === newUserId)\n    ) {\n      setUsers([...users, { userId: newUserId, permissions: userPermissions }]);\n      setNewUserId(\"\");\n      setPermissions({ view: false, edit: false });\n      setError(\"\");\n    } else {\n      setError(\n        \"Please enter a valid user ID and select at least one permission.\"\n      );\n    }\n  };\n\n  const handleRemoveUser = (userId) => {\n    setUsers(users.filter((user) => user.userId !== userId));\n  };\n\n  const handlePermissionChange = (e) => {\n    const { name, checked } = e.target;\n    setPermissions({ ...permissions, [name]: checked });\n  };\n\n  const handleSave = () => {\n    let su = [];\n    for (var i = 0; i < sharedUsers.length; i++) {\n      su.push({\n        userId: sharedUsers[i].userId,\n        permission: sharedUsers[i].permissions.join(\",\"),\n      });\n    }\n    console.log(su);\n    fetch(\"http://127.0.0.1:5000/updateFilePermissions\", {\n      method: \"POST\",\n      credentials: \"include\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        userId: currentUser,\n        fileId: fileId,\n        sharedUsers: su,\n      }),\n    })\n      .then((res) => {\n        if (res.status === 200) {\n          res.json().then((res) => {\n            dispatch(updateSharedUsers({ fileId, sharedUsers: users }));\n          });\n        } else {\n          res.json().then((res) => {\n            alert(res.message);\n          });\n        }\n      })\n      .catch((err) => {\n        alert(\"Failed to fetch documents due to : \\n\" + err.message);\n      });\n    onClose();\n  };\n\n  return (\n    <div className=\"popup\">\n      <div className=\"popup-inner\">\n        <h2>Share Document</h2>\n        <div>\n          <input\n            type=\"text\"\n            placeholder=\"Enter user ID\"\n            value={newUserId}\n            onChange={(e) => setNewUserId(e.target.value)}\n          />\n          <div>\n            <label>\n              <input\n                type=\"checkbox\"\n                name=\"view\"\n                checked={permissions.view}\n                onChange={handlePermissionChange}\n              />\n              View\n            </label>\n            <label>\n              <input\n                type=\"checkbox\"\n                name=\"edit\"\n                checked={permissions.edit}\n                onChange={handlePermissionChange}\n              />\n              Edit\n            </label>\n          </div>\n          <button onClick={handleAddUser}>Add User</button>\n          {error && <p className=\"error\">{error}</p>}\n        </div>\n        <ul>\n          {users.map((user) => (\n            <li key={user.userId}>\n              <span>\n                {user.userId} - {user.permissions.join(\", \")}\n              </span>\n              <button onClick={() => handleRemoveUser(user.userId)}>\n                Remove\n              </button>\n            </li>\n          ))}\n        </ul>\n        <button onClick={handleSave}>Save</button>\n        <button onClick={onClose}>Cancel</button>\n      </div>\n    </div>\n  );\n};\n\nexport default SharePopup;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}