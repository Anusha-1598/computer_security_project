{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import DOMPurify from\"dompurify\";import{useNavigate}from\"react-router-dom\";import{setLoginData,resetLoginForm,setLoginUser}from\"../redux/loginSlice\";import FormInput from\"./FormInput\";import Button from\"./Button\";import\"./Login.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const dispatch=useDispatch();const loginData=useSelector(state=>state.login);const[errors,setErrors]=useState({});const[message,setMessage]=useState(\"\");const[passwordVisible,setPasswordVisible]=useState(false);const navigate=useNavigate();const handleChange=e=>{const sanitizedValue=DOMPurify.sanitize(e.target.value);dispatch(setLoginData({name:e.target.name,value:sanitizedValue}));};useEffect(()=>{fetch(\"http://127.0.0.1:5000/verifyCookie\",{method:\"POST\",credentials:\"include\"}).then(res=>{if(res.status===200){res.json().then(res=>{dispatch(setLoginUser(res.userId));let goToDashBoard=()=>navigate(\"/dashboard\");goToDashBoard();});}}).catch(err=>{// alert(err.message);\n});},[]);const validate=()=>{const errors={};if(!loginData.username.trim()){errors.username=\"Username is required\";}if(!loginData.password){errors.password=\"Password is required\";}return errors;};const handleSubmit=async e=>{e.preventDefault();const validationErrors=validate();if(Object.keys(validationErrors).length>0){setErrors(validationErrors);return;}try{const response=await fetch(\"http://127.0.0.1:5000/login\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({username:loginData.username,password:loginData.password})});const data=await response.json();if(response.ok){setMessage(\"Login successful!\");dispatch(setLoginUser(loginData.username));dispatch(resetLoginForm());let goToDashBoard=()=>navigate(\"/dashboard\");goToDashBoard();}else{setMessage(\"Login failed: \".concat(data.message));}}catch(error){setMessage(\"Login failed: \".concat(error.message));}};return/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),message&&/*#__PURE__*/_jsx(\"p\",{children:message}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(FormInput,{type:\"text\",name:\"username\",label:\"Username\",value:loginData.username,onChange:handleChange,error:errors.username}),/*#__PURE__*/_jsx(FormInput,{type:passwordVisible?\"text\":\"password\",name:\"password\",label:\"Password\",value:loginData.password,onChange:handleChange,error:errors.password,toggleVisibility:()=>setPasswordVisible(!passwordVisible),isPassword:true}),/*#__PURE__*/_jsx(Button,{type:\"submit\",label:\"Login\"})]})]});};export default Login;","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","DOMPurify","useNavigate","setLoginData","resetLoginForm","setLoginUser","FormInput","Button","jsx","_jsx","jsxs","_jsxs","Login","dispatch","loginData","state","login","errors","setErrors","message","setMessage","passwordVisible","setPasswordVisible","navigate","handleChange","e","sanitizedValue","sanitize","target","value","name","fetch","method","credentials","then","res","status","json","userId","goToDashBoard","catch","err","validate","username","trim","password","handleSubmit","preventDefault","validationErrors","Object","keys","length","response","headers","body","JSON","stringify","data","ok","concat","error","className","children","onSubmit","type","label","onChange","toggleVisibility","isPassword"],"sources":["/workspaces/computer_security_project/frontend/src/components/Login.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport DOMPurify from \"dompurify\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport {\r\n  setLoginData,\r\n  resetLoginForm,\r\n  setLoginUser,\r\n} from \"../redux/loginSlice\";\r\nimport FormInput from \"./FormInput\";\r\nimport Button from \"./Button\";\r\nimport \"./Login.css\";\r\n\r\nconst Login = () => {\r\n  const dispatch = useDispatch();\r\n  const loginData = useSelector((state) => state.login);\r\n  const [errors, setErrors] = useState({});\r\n  const [message, setMessage] = useState(\"\");\r\n  const [passwordVisible, setPasswordVisible] = useState(false);\r\n  const navigate = useNavigate();\r\n  const handleChange = (e) => {\r\n    const sanitizedValue = DOMPurify.sanitize(e.target.value);\r\n    dispatch(setLoginData({ name: e.target.name, value: sanitizedValue }));\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetch(\"http://127.0.0.1:5000/verifyCookie\", {\r\n      method: \"POST\",\r\n      credentials: \"include\",\r\n    })\r\n      .then((res) => {\r\n        if (res.status === 200) {\r\n          res.json().then((res) => {\r\n            dispatch(setLoginUser(res.userId));\r\n            let goToDashBoard = () => navigate(\"/dashboard\");\r\n            goToDashBoard();\r\n          });\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        // alert(err.message);\r\n      });\r\n  }, []);\r\n\r\n  const validate = () => {\r\n    const errors = {};\r\n    if (!loginData.username.trim()) {\r\n      errors.username = \"Username is required\";\r\n    }\r\n    if (!loginData.password) {\r\n      errors.password = \"Password is required\";\r\n    }\r\n    return errors;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const validationErrors = validate();\r\n    if (Object.keys(validationErrors).length > 0) {\r\n      setErrors(validationErrors);\r\n      return;\r\n    }\r\n    try {\r\n      const response = await fetch(\"http://127.0.0.1:5000/login\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          username: loginData.username,\r\n          password: loginData.password,\r\n        }),\r\n      });\r\n      const data = await response.json();\r\n      if (response.ok) {\r\n        setMessage(\"Login successful!\");\r\n        dispatch(setLoginUser(loginData.username));\r\n        dispatch(resetLoginForm());\r\n        let goToDashBoard = () => navigate(\"/dashboard\");\r\n        goToDashBoard();\r\n      } else {\r\n        setMessage(`Login failed: ${data.message}`);\r\n      }\r\n    } catch (error) {\r\n      setMessage(`Login failed: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"login\">\r\n      <h2>Login</h2>\r\n      {message && <p>{message}</p>}\r\n      <form onSubmit={handleSubmit}>\r\n        <FormInput\r\n          type=\"text\"\r\n          name=\"username\"\r\n          label=\"Username\"\r\n          value={loginData.username}\r\n          onChange={handleChange}\r\n          error={errors.username}\r\n        />\r\n        <FormInput\r\n          type={passwordVisible ? \"text\" : \"password\"}\r\n          name=\"password\"\r\n          label=\"Password\"\r\n          value={loginData.password}\r\n          onChange={handleChange}\r\n          error={errors.password}\r\n          toggleVisibility={() => setPasswordVisible(!passwordVisible)}\r\n          isPassword\r\n        />\r\n        <Button type=\"submit\" label=\"Login\" />\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}